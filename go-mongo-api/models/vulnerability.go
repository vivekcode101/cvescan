package models

import "go.mongodb.org/mongo-driver/bson/primitive"

type Vulnerability struct {
    Message      string `bson:"message"` 
    Image       string `bson:"image"`
    ID           primitive.ObjectID `bson:"_id,omitempty"`
    Vulnerability VulnerabilityDetails `bson:"vulnerability"`
	
    // RelatedVulnerabilities []RelatedVulnerability `bson:"relatedVulnerabilities"`
    // MatchDetails []MatchDetail `bson:"matchDetails"`
    // Artifact     ArtifactDetails `bson:"artifact"`
}

type VulnerabilityDetails struct {
    ID          string   `bson:"id"`
    DataSource  string   `bson:"dataSource"`
    Namespace   string   `bson:"namespace"`
    Severity    string   `bson:"severity"`
    URLs        []string `bson:"urls"`
    CVSS        []CVSS   `bson:"cvss"`
    Fix         Fix      `bson:"fix"`
    Advisories  []string `bson:"advisories"`
}

type RelatedVulnerability struct {
    ID          string   `bson:"id"`
    DataSource  string   `bson:"dataSource"`
    Namespace   string   `bson:"namespace"`
    Severity    string   `bson:"severity"`
    URLs        []string `bson:"urls"`
    Description string   `bson:"description"`
    CVSS        []CVSS   `bson:"cvss"`
}

type CVSS struct {
    Version string `bson:"version"`
    Vector  string `bson:"vector"`
    Metrics CVSSMetrics `bson:"metrics"`
}

type CVSSMetrics struct {
    BaseScore           float64 `bson:"baseScore"`
    ExploitabilityScore float64 `bson:"exploitabilityScore"`
    ImpactScore         float64 `bson:"impactScore"`
}

type Fix struct {
    Versions []string `bson:"versions"`
    State    string   `bson:"state"`
}

type MatchDetail struct {
    Matcher    string `bson:"matcher"`
    SearchedBy SearchedBy `bson:"searchedBy"`
    Found      FoundDetail `bson:"found"`
}

type SearchedBy struct {
    Distro    Distro `bson:"distro"`
    Namespace string `bson:"namespace"`
}

type Distro struct {
    Type    string `bson:"type"`
    Version string `bson:"version"`
}

type FoundDetail struct {
    VersionConstraint string `bson:"versionConstraint"`
}

type ArtifactDetails struct {
    Name      string `bson:"name"`
    Version   string `bson:"version"`
    Type      string `bson:"type"`
    Locations []Location `bson:"locations"`
    Language  string `bson:"language"`
    Licenses  []string `bson:"licenses"`
    CPES      []string `bson:"cpes"`
    PURL      string `bson:"purl"`
    Metadata  Metadata `bson:"metadata"`
}

type Location struct {
    Path    string `bson:"path"`
    LayerID string `bson:"layerID"`
}

type Metadata struct {
    Source string `bson:"Source"`
}
